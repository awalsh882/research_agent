<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Research Agent</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <div class="title-section">
            <h1>Investment Research Agent</h1>
            <p>Conversational research assistant for institutional investors</p>
        </div>
        <div class="hint">
            Type <code>/</code> for commands
        </div>
    </header>

    <div class="split-container">
        <!-- Left: Files Pane -->
        <div class="files-pane" id="files-pane">
            <div class="files-header">
                <h2>Files</h2>
                <div style="display: flex; gap: 0.25rem; align-items: center;">
                    <button class="files-refresh" onclick="refreshFiles()" title="Refresh">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                        </svg>
                    </button>
                    <button class="collapse-btn" onclick="toggleFilesPane()" title="Toggle panel">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="files-content" id="files-content">
                <div class="files-empty">Loading files...</div>
            </div>

            <!-- Tasks section -->
            <div class="tasks-section" id="tasks-section">
                <div class="tasks-header">
                    <h3>Tasks</h3>
                    <button class="tasks-refresh" onclick="refreshTasks()" title="Refresh">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                            <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                            <path d="M21 3v5h-5"/>
                        </svg>
                    </button>
                </div>
                <div class="tasks-content" id="tasks-content">
                    <div class="tasks-empty">No active tasks</div>
                </div>
            </div>
        </div>

        <!-- Resizer for files pane -->
        <div class="resizer-files" id="resizer-files"></div>

        <!-- Middle: Viewer Pane -->
        <div class="viewer-pane" id="viewer-pane">
            <div class="viewer-header">
                <h2>Viewer</h2>
                <div class="viewer-tabs">
                    <button class="viewer-tab active" data-tab="preview">Preview</button>
                    <button class="viewer-tab" data-tab="data">Data</button>
                    <button class="viewer-tab" data-tab="charts">Charts</button>
                </div>
            </div>
            <div class="viewer-content" id="viewer-content">
                <div class="viewer-placeholder">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M9 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-4"/>
                        <path d="M12 15v6"/>
                        <path d="M8 21h8"/>
                        <path d="M7 9h2"/>
                        <path d="M7 13h6"/>
                    </svg>
                    <p>Research outputs, charts, and data visualizations will appear here as you interact with the agent.</p>
                </div>
            </div>
        </div>

        <!-- Resizer -->
        <div class="resizer" id="resizer"></div>

        <!-- Right: Chat Pane -->
        <div class="chat-pane">
            <div class="agent-toast" id="agent-toast">
                <span class="toast-icon"></span>
                <span class="toast-text"></span>
                <button class="toast-stop" onclick="stopGeneration()">Stop</button>
            </div>
            <div id="chat-container"></div>

            <div class="input-area">
                <div id="input-container">
                    <div class="input-wrapper">
                        <div class="command-menu" id="command-menu"></div>
                        <textarea
                            id="query-input"
                            placeholder="Ask a research question... (/ for commands)"
                            rows="2"
                        ></textarea>
                    </div>
                    <div class="input-buttons">
                        <button id="send-btn" onclick="sendMessage()">Send</button>
                        <button id="stop-btn" onclick="stopGeneration()">Stop</button>
                    </div>
                </div>
                <div class="model-selector">
                    <label for="model-select">Model:</label>
                    <select id="model-select" onchange="changeModel(this.value)">
                        <option value="claude-sonnet-4-20250514">Claude Sonnet 4</option>
                        <option value="claude-opus-4-20250514">Claude Opus 4</option>
                        <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                        <option value="claude-3-5-haiku-20241022">Claude 3.5 Haiku</option>
                    </select>
                </div>
            </div>

            <div class="status-bar">
                <div id="status">Connecting...</div>
                <div id="queue-status"></div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
